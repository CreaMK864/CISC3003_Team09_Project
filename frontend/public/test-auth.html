<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chat Application</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#5D5CDE',
                    }
                }
            }
        };

        // Check for dark mode preference
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });
    </script>
    <script src="https://accounts.google.com/gsi/client" async></script>
    <style>
        .tab-active {
            color: #5D5CDE;
            border-bottom: 2px solid #5D5CDE;
        }
        
        .dark .tab-active {
            border-color: #5D5CDE;
        }
        
        .user-message {
            background-color: #e9ecef;
            color: #212529;
            align-self: flex-end;
            border-radius: 1rem 1rem 0 1rem;
            margin-left: 2rem;
        }
        
        .bot-message {
            background-color: #5D5CDE;
            color: white;
            align-self: flex-start;
            border-radius: 1rem 1rem 1rem 0;
            margin-right: 2rem;
        }
        
        .error-message {
            background-color: #f8d7da;
            color: #721c24;
            align-self: center;
            border-radius: 0.5rem;
            width: 100%;
        }
        
        .dark .user-message {
            background-color: #495057;
            color: #f8f9fa;
        }
        
        .dark .bot-message {
            background-color: #6c63ff;
        }
        
        .dark .error-message {
            background-color: #471b1e;
            color: #f8d7da;
        }
        
        .message {
            padding: 0.75rem 1rem;
            margin-bottom: 0.75rem;
            max-width: 75%;
            word-wrap: break-word;
        }
        
        #chat-messages {
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            height: 100%;
            padding: 1rem;
        }
    </style>
</head>
<body class="bg-white dark:bg-gray-900 text-gray-800 dark:text-gray-200 min-h-screen flex flex-col">
    <div class="container mx-auto px-4 py-6 max-w-4xl flex-grow flex flex-col">
        <h1 class="text-3xl font-bold text-center mb-6 text-primary">AI Chat Application</h1>
        
        <!-- Auth Section -->
        <div id="auth-section" class="mb-6">
            <div class="flex mb-4 border-b dark:border-gray-700">
                <button id="loginTab" class="py-2 px-4 font-semibold tab-active" onclick="showTab('login')">Login</button>
                <button id="registerTab" class="py-2 px-4 font-semibold" onclick="showTab('register')">Register</button>
                <button id="resetTab" class="py-2 px-4 font-semibold" onclick="showTab('reset')">Reset Password</button>
            </div>
            
            <!-- Login Form -->
            <div id="loginForm" class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md mb-4">
                <h2 class="text-xl font-semibold mb-4">Login to your account</h2>
                <div class="mb-4">
                    <label for="loginEmail" class="block mb-2 text-sm font-medium">Email</label>
                    <input type="email" id="loginEmail" class="w-full px-3 py-2 text-base border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="your@email.com">
                </div>
                <div class="mb-6">
                    <label for="loginPassword" class="block mb-2 text-sm font-medium">Password</label>
                    <input type="password" id="loginPassword" class="w-full px-3 py-2 text-base border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="••••••••">
                </div>
                <button onclick="loginWithForm()" class="w-full py-2 px-4 bg-primary text-white font-semibold rounded-md hover:bg-opacity-90 transition-colors">
                    Sign In
                </button>
                
                <div class="mt-4 text-center">
                    <p class="text-sm mb-4">Or sign in with:</p>
                    <button onclick="signInWithGoogle()" class="py-2 px-4 border dark:border-gray-600 rounded-md flex items-center justify-center w-full hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                        <svg class="h-5 w-5 mr-2" viewBox="0 0 24 24">
                            <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4" />
                            <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853" />
                            <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05" />
                            <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335" />
                        </svg>
                        Sign in with Google
                    </button>
                </div>
            </div>
            
            <!-- Register Form -->
            <div id="registerForm" class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md mb-4 hidden">
                <h2 class="text-xl font-semibold mb-4">Create an account</h2>
                <div class="mb-4">
                    <label for="registerEmail" class="block mb-2 text-sm font-medium">Email</label>
                    <input type="email" id="registerEmail" class="w-full px-3 py-2 text-base border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="your@email.com">
                </div>
                <div class="mb-6">
                    <label for="registerPassword" class="block mb-2 text-sm font-medium">Password</label>
                    <input type="password" id="registerPassword" class="w-full px-3 py-2 text-base border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="••••••••">
                </div>
                <button onclick="register()" class="w-full py-2 px-4 bg-primary text-white font-semibold rounded-md hover:bg-opacity-90 transition-colors">
                    Sign Up
                </button>
                
                <div class="mt-4 text-center">
                    <p class="text-sm mb-4">Or sign up with:</p>
                    <button onclick="signInWithGoogle()" class="py-2 px-4 border dark:border-gray-600 rounded-md flex items-center justify-center w-full hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors">
                        <svg class="h-5 w-5 mr-2" viewBox="0 0 24 24">
                            <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4" />
                            <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853" />
                            <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05" />
                            <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335" />
                        </svg>
                        Sign up with Google
                    </button>
                </div>
            </div>
            
            <!-- Reset Password Form -->
            <div id="resetForm" class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md mb-4 hidden">
                <h2 class="text-xl font-semibold mb-4">Reset your password</h2>
                <div class="mb-6">
                    <label for="resetEmail" class="block mb-2 text-sm font-medium">Email</label>
                    <input type="email" id="resetEmail" class="w-full px-3 py-2 text-base border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white" placeholder="your@email.com">
                </div>
                <button onclick="resetPassword()" class="w-full py-2 px-4 bg-primary text-white font-semibold rounded-md hover:bg-opacity-90 transition-colors">
                    Send Reset Email
                </button>
            </div>
            
            <!-- Status Messages -->
            <div id="statusMessage" class="hidden p-4 rounded-md mt-4"></div>
        </div>
        
        <!-- Chat Section -->
        <div id="chat-section" class="flex-grow flex flex-col hidden">
            <div class="chat-header bg-white dark:bg-gray-800 p-4 rounded-t-lg shadow-sm">
                <div class="flex justify-between items-center">
                    <h2 class="text-xl font-semibold">Conversation</h2>
                    <button onclick="signOut()" class="text-primary hover:text-opacity-80">Sign Out</button>
                </div>
            </div>
            <div class="chat-body bg-gray-100 dark:bg-gray-800 flex-grow rounded-b-lg shadow-md flex flex-col" style="height: 400px;">
                <div id="chat-messages" class="flex-grow overflow-y-auto p-4"></div>
                <form id="message-form" class="p-4 bg-white dark:bg-gray-700 rounded-b-lg">
                    <div class="flex items-center">
                        <input 
                            type="text" 
                            id="message-input" 
                            class="flex-grow px-4 py-2 text-base border rounded-l-md focus:outline-none focus:ring-2 focus:ring-primary dark:bg-gray-800 dark:border-gray-600 dark:text-white" 
                            placeholder="Type a message..."
                        >
                        <button type="submit" class="bg-primary text-white px-4 py-2 rounded-r-md hover:bg-opacity-90">
                            Send
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    
    <!-- Config file (placeholder) -->
    <script>
        // Configuration constants
        const SUPABASE_URL = 'YOUR_SUPABASE_URL';
        const SUPABASE_ANON_KEY = 'YOUR_SUPABASE_ANON_KEY';
        const API_BASE_URL = 'YOUR_API_BASE_URL'; // Replace with your actual API base URL
    </script>
    
    <!-- Imported from auth.js -->
    <script type="module">
        import { createClient } from "https://esm.sh/@supabase/supabase-js@2";

        // Initialize Supabase client
        const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        /** @type {import('@supabase/supabase-js').User|null} */
        let currentUser = null;

        /**
         * Check if user is already authenticated and initialize the app
         * @returns {Promise<import("@supabase/supabase-js").User | null>}
         */
        async function initializeAuth() {
            // Get session from local storage
            const {
                data: { session },
            } = await supabase.auth.getSession();

            if (session) {
                currentUser = session.user;
                console.log("User is authenticated:", currentUser.email);
                document.getElementById('auth-section').classList.add('hidden');
                document.getElementById('chat-section').classList.remove('hidden');
                return session.user;
            } else {
                document.getElementById('auth-section').classList.remove('hidden');
                document.getElementById('chat-section').classList.add('hidden');
                return null;
            }
        }

        /**
         * Show login form to prompt for credentials
         * @returns {void}
         */
        function showLoginForm() {
            document.getElementById('auth-section').classList.remove('hidden');
            document.getElementById('chat-section').classList.add('hidden');
            showTab('login');
        }

        /**
         * Sign in user with email and password
         * @param {string} email - User's email
         * @param {string} password - User's password
         * @returns {Promise<import('@supabase/supabase-js').User|null>}
         */
        async function signInWithEmail(email, password) {
            try {
                /** @type {import('@supabase/supabase-js').AuthResponse} */
                const { data, error } = await supabase.auth.signInWithPassword({
                    email,
                    password,
                });

                if (error) throw error;

                currentUser = data.user;
                console.log("Signed in successfully:", currentUser.email);
                document.getElementById('auth-section').classList.add('hidden');
                document.getElementById('chat-section').classList.remove('hidden');
                return currentUser;
            } catch (error) {
                console.error("Error signing in:", error.message);
                showMessage("Login failed: " + error.message, true);
                return null;
            }
        }

        /**
         * Get the authentication token from Supabase
         * @returns {Promise<string>} The access token
         */
        async function getAuthToken() {
            const {
                data: { session },
            } = await supabase.auth.getSession();
            return session?.access_token || "";
        }

        /**
         * Sign out the current user
         * @returns {Promise<void>}
         */
        async function signOut() {
            const { error } = await supabase.auth.signOut();
            if (error) {
                console.error("Error signing out:", error.message);
                showMessage("Error signing out: " + error.message, true);
            } else {
                currentUser = null;
                document.getElementById('auth-section').classList.remove('hidden');
                document.getElementById('chat-section').classList.add('hidden');
                showMessage("Successfully signed out");
            }
        }

        /**
         * Get the current user
         * @returns {import('@supabase/supabase-js').User|null} The current user
         */
        function getCurrentUser() {
            return currentUser;
        }

        // Expose functions to global scope
        window.initializeAuth = initializeAuth;
        window.showLoginForm = showLoginForm;
        window.signInWithEmail = signInWithEmail;
        window.getAuthToken = getAuthToken;
        window.signOut = signOut;
        window.getCurrentUser = getCurrentUser;
        window.supabase = supabase;
    </script>
    
    <!-- Imported from app.js -->
    <script type="module">
        // DOM elements
        /** @type {HTMLFormElement} */
        const messageForm = document.getElementById("message-form");
        /** @type {HTMLInputElement} */
        const messageInput = document.getElementById("message-input");
        /** @type {HTMLDivElement} */
        const messagesContainer = document.getElementById("chat-messages");

        /** @type {WebSocket|null} */
        let activeSocket = null;
        /** @type {number|null} */
        let currentConversationId = null;

        /**
         * Initialize the application
         * @returns {Promise<void>}
         */
        async function initialize() {
            const user = await window.initializeAuth();

            if (user) {
                await getOrCreateConversation();
            } else {
                console.log("User not authenticated");
            }
        }

        /**
         * Get existing conversations or create a new one
         * @returns {Promise<void>}
         */
        async function getOrCreateConversation() {
            try {
                // Get existing conversations for the user
                const response = await fetch(`${API_BASE_URL}/conversations`, {
                    method: "GET",
                    headers: {
                        Authorization: `Bearer ${await window.getAuthToken()}`,
                    },
                });

                if (!response.ok) {
                    throw new Error(
                        `HTTP error! Status: ${response.status} - ${await response.text()}`,
                    );
                }

                /** @type {Array<{id: number, title: string}>} */
                const conversations = await response.json();

                if (conversations.length > 0) {
                    currentConversationId = conversations[0].id;
                    document.querySelector(".chat-header h2").textContent =
                        conversations[0].title;
                } else {
                    await createNewConversation();
                }

                localStorage.setItem(
                    "current_conversation_id",
                    currentConversationId.toString(),
                );
            } catch (error) {
                console.error("Error getting conversations:", error);
                displayErrorMessage(
                    "Failed to load conversations. Using a default conversation.",
                );
                // Fallback to a default conversation ID
                currentConversationId = 1;
                document.querySelector(".chat-header h2").textContent =
                    "Default Conversation";
                localStorage.setItem(
                    "current_conversation_id",
                    currentConversationId.toString(),
                );
            }
        }

        /**
         * Create a new conversation
         * @returns {Promise<void>}
         */
        async function createNewConversation() {
            try {
                const response = await fetch(`${API_BASE_URL}/conversations/`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        Authorization: `Bearer ${await window.getAuthToken()}`,
                    },
                    body: JSON.stringify({
                        title: "New Conversation",
                        model: "gpt-4.1-nano",
                    }),
                });

                if (!response.ok) {
                    throw new Error(
                        `HTTP error! Status: ${response.status} - ${await response.text()}`,
                    );
                }

                /** @type {{id: number, title: string}} */
                const conversation = await response.json();
                currentConversationId = conversation.id;
                document.querySelector(".chat-header h2").textContent = conversation.title;
            } catch (error) {
                console.error("Error creating conversation:", error);
                throw error; // Let the caller handle the error
            }
        }

        /**
         * Display a message in the chat UI
         * @param {string} content - The message content
         * @param {string} role - The role of the sender ('user' or 'assistant')
         * @returns {void}
         */
        function displayMessage(content, role) {
            const messageElement = document.createElement("div");
            messageElement.classList.add("message");
            messageElement.classList.add(
                role === "user" ? "user-message" : "bot-message",
            );
            messageElement.textContent = content;

            messagesContainer.appendChild(messageElement);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        /**
         * Display an error message in the chat UI
         * @param {string} content - The error message content
         * @returns {void}
         */
        function displayErrorMessage(content) {
            const messageElement = document.createElement("div");
            messageElement.classList.add("message", "error-message");
            messageElement.textContent = content;

            messagesContainer.appendChild(messageElement);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        /**
         * Send a message to the API and handle the streamed response
         * @param {string} content - The message content
         * @returns {Promise<void>}
         */
        async function sendMessage(content) {
            try {
                if (!window.getCurrentUser()) {
                    displayErrorMessage("You need to be logged in to send messages.");
                    window.showLoginForm();
                    return;
                }

                if (!currentConversationId) {
                    await getOrCreateConversation();
                }

                displayMessage(content, "user");

                const botMessageElement = document.createElement("div");
                botMessageElement.classList.add("message", "bot-message");
                botMessageElement.textContent = "";
                messagesContainer.appendChild(botMessageElement);

                const response = await fetch(`${API_BASE_URL}/chat`, {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                        Authorization: `Bearer ${await window.getAuthToken()}`,
                    },
                    body: JSON.stringify({
                        conversation_id: getCurrentConversationId(),
                        role: "user",
                        content: content,
                    }),
                });

                if (!response.ok) {
                    throw new Error(
                        `HTTP error! Status: ${response.status} - ${await response.text()}`,
                    );
                }

                /** @type {{ws_url: string}} */
                const data = await response.json();
                const wsUrl = data.ws_url;

                if (activeSocket && activeSocket.readyState === WebSocket.OPEN) {
                    activeSocket.close();
                }

                activeSocket = new WebSocket(wsUrl);

                /** @type {string} */
                let fullResponse = "";

                activeSocket.addEventListener("open", () => {
                    console.log("Connected to WebSocket for streaming response");
                });

                activeSocket.addEventListener("message", (event) => {
                    try {
                        /** @type {{error?: string, event?: string}} */
                        const jsonData = JSON.parse(event.data);

                        // Check if this is an error or event message
                        if (jsonData.error) {
                            console.error("Error from server:", jsonData.error);
                            botMessageElement.textContent = `Error: ${jsonData.error}`;
                            return;
                        }

                        if (jsonData.event === "chat_ended") {
                            console.log("Chat response complete");
                            return;
                        }

                        // If we got here, it's actually a JSON message, append it
                        fullResponse += JSON.stringify(jsonData);
                        botMessageElement.textContent = fullResponse;
                    } catch {
                        // Not JSON, so it's a plain text chunk of the response
                        fullResponse += event.data;
                        botMessageElement.textContent = fullResponse;
                    }

                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                });

                activeSocket.addEventListener("close", () => {
                    console.log("Disconnected from WebSocket");
                });

                activeSocket.addEventListener("error", (event) => {
                    console.error("WebSocket error:", event);
                    botMessageElement.textContent =
                        "Error: Failed to connect to response stream";
                });

                // Clear the input
                messageInput.value = "";
            } catch (error) {
                console.error("Error sending message:", error);
                displayErrorMessage("Failed to send message: " + error.message);
            }
        }

        /**
         * Get the current conversation ID
         * @returns {number|null} The current conversation ID
         */
        function getCurrentConversationId() {
            return currentConversationId;
        }

        // Handle form submission
        messageForm.addEventListener("submit", (event) => {
            event.preventDefault();

            const message = messageInput.value.trim();
            if (message) {
                sendMessage(message);
            }
        });

        // Make functions available to the window scope
        window.sendMessage = sendMessage;
        window.displayMessage = displayMessage;
        window.displayErrorMessage = displayErrorMessage;
        window.getOrCreateConversation = getOrCreateConversation;

        // Initialize the app when the page loads
        document.addEventListener("DOMContentLoaded", () => {
            initialize();
        });
    </script>
    
    <!-- UI Functionality -->
    <script>
        // Tab switching functionality
        function showTab(tabName) {
            // Hide all forms
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('registerForm').classList.add('hidden');
            document.getElementById('resetForm').classList.add('hidden');
            
            // Reset active tab styles
            document.getElementById('loginTab').classList.remove('tab-active');
            document.getElementById('registerTab').classList.remove('tab-active');
            document.getElementById('resetTab').classList.remove('tab-active');
            
            // Show selected form and activate tab
            if (tabName === 'login') {
                document.getElementById('loginForm').classList.remove('hidden');
                document.getElementById('loginTab').classList.add('tab-active');
            } else if (tabName === 'register') {
                document.getElementById('registerForm').classList.remove('hidden');
                document.getElementById('registerTab').classList.add('tab-active');
            } else if (tabName === 'reset') {
                document.getElementById('resetForm').classList.remove('hidden');
                document.getElementById('resetTab').classList.add('tab-active');
            }
        }
        
        // Show status message
        function showMessage(message, isError = false) {
            const statusEl = document.getElementById('statusMessage');
            statusEl.textContent = message;
            statusEl.classList.remove('hidden', 'bg-green-100', 'text-green-800', 'bg-red-100', 'text-red-800');
            if (isError) {
                statusEl.classList.add('bg-red-100', 'text-red-800', 'dark:bg-red-900', 'dark:text-red-200');
            } else {
                statusEl.classList.add('bg-green-100', 'text-green-800', 'dark:bg-green-900', 'dark:text-green-200');
            }
        }
        
        // Email/Password Login from Form
        async function loginWithForm() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!email || !password) {
                showMessage('Please enter both email and password', true);
                return;
            }
            
            const user = await signInWithEmail(email, password);
            if (user) {
                showMessage('Login successful!');
            }
        }
        
        // Email/Password Registration
        async function register() {
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            
            if (!email || !password) {
                showMessage('Please enter both email and password', true);
                return;
            }
            
            try {
                const { data, error } = await supabase.auth.signUp({
                    email,
                    password,
                    options: {
                        emailRedirectTo: window.location.origin,
                    }
                });
                
                if (error) throw error;
                
                showMessage('Registration successful! Please check your email for confirmation.');
                setTimeout(() => {
                    showTab('login');
                }, 2000);
            } catch (error) {
                showMessage(`Error: ${error.message}`, true);
            }
        }
        
        // Reset password
        async function resetPassword() {
            const email = document.getElementById('resetEmail').value;
            
            if (!email) {
                showMessage('Please enter your email address', true);
                return;
            }
            
            try {
                const { data, error } = await supabase.auth.resetPasswordForEmail(email, {
                    redirectTo: window.location.origin + '/update-password',
                });
                
                if (error) throw error;
                
                showMessage('Password reset email sent. Please check your inbox.');
            } catch (error) {
                showMessage(`Error: ${error.message}`, true);
            }
        }
        
        // Sign in with Google
        async function signInWithGoogle() {
            try {
                const { data, error } = await supabase.auth.signInWithOAuth({
                    provider: 'google',
                    options: {
                        redirectTo: window.location.origin,
                    }
                });
                
                if (error) throw error;
                
                // Redirect handled automatically by Supabase Auth
            } catch (error) {
                showMessage(`Error: ${error.message}`, true);
            }
        }
    </script>
</body>
</html>